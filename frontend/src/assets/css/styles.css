/* Jobs/Ive + Slack Design System */
:root{
  --bg: var(--bg-primary); --bg-2:var(--neutral-200); --surface:var(--neutral-200); --b:var(--alias-383d45);
  --text:var(--text-primary); --muted:var(--alias-9ea2aa);
  --accent:var(--color-primary-dark); --ok:var(--success); --warn:var(--warning); --err:var(--error);
  --dev:var(--alias-7dd3fc); --pub:var(--alias-fca5a5); --inv:var(--warning); --sp:var(--alias-86efac);
  --shadow: 0 var(--s-2) var(--s-6) rgba(0,0,0,.35);
  --r:var(--s-4); --r-sm:var(--s-3); --r-xs:var(--s-2); --gap:var(--s-3);
  --fast:150ms; --norm:220ms; --ease: cubic-bezier(0,0,0.2,1);
  
  /* accent rail */
  --rail-w: var(--s-1-5);
  --rail-radius: var(--s-2-5);
  --rail-start: var(--accent-cyan);
  --rail-end: var(--accent-magenta);
  --rail-glow: 0 0 var(--s-4-5) var(--glow-magenta), 0 0 var(--s-3) var(--glow-cyan);
}

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.4 Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}

.app{display:flex;min-height:100vh;}
.sidenav{
  width:17.5rem;flex:0 0 17.5rem;display:flex;flex-direction:column;
  background:var(--bg-2);border-right:1px solid var(--b);position:sticky;top:0;height:100vh;z-index:30;
}
.side-head{padding:var(--s-3-5) var(--s-3);border-bottom:1px solid var(--b)}
.brand{font-weight:800;letter-spacing:0.019rem}
.workspace{color:var(--muted);font-size:0.75rem;margin-top:var(--s-1)}
.side-nav{padding:var(--s-2);display:grid;gap:var(--s-1-5)}
.nav-item{
  position:relative;
  width:100%;padding:var(--s-2-5) var(--s-3);padding-left:calc(var(--s-4) + var(--rail-w) + var(--s-2-5));
  border-radius:var(--r-lg,10px);background:transparent;color:var(--text-secondary,var(--alias-a1a1a1));
  border:1px solid transparent;text-align:left;transition:background var(--fast) var(--ease), border-color var(--fast) var(--ease), color var(--fast) var(--ease)
}
.nav-item:hover{background:rgba(255,255,255,.04);color:var(--text-primary,var(--text-primary));border-color:var(--b)}
.nav-item.active{background:rgba(255,255,255,.04);color:var(--text-primary)}
.nav-item.active::before{
  content:"";
  position:absolute;
  left:var(--s-2);
  top:var(--s-2);
  bottom:var(--s-2);
  width:var(--rail-w);
  border-radius:var(--rail-radius);
  background:linear-gradient(180deg,var(--rail-start),var(--rail-end));
  box-shadow:var(--rail-glow);
}
.pill{padding:var(--s-0-5) var(--s-2);border-radius: var(--r-pill);font-size:0.75rem;margin-left:var(--s-2)}
.pill-gold{background:rgba(255,215,0,.18);border:1px solid rgba(255,215,0,.45);color:var(--accent-warning)}
.side-footer{margin-top:auto;padding:var(--s-2);color:var(--muted);font-size:0.75rem}

/* Authentication UI styling */
.auth-section{margin-bottom:var(--s-3)}
.auth-buttons{display:flex;flex-direction:column;gap:var(--s-2);margin-bottom:var(--s-2)}
.auth-btn{width:100%;text-align:left;justify-content:flex-start}
.user-profile{display:flex;flex-direction:column;gap:var(--s-2)}
.user-profile.hidden{display:none}
.user-info{display:flex;align-items:center;gap:var(--s-2);padding:var(--s-2);background:var(--surface);border-radius: var(--r-md);border:1px solid var(--b)}
.user-avatar{width:var(--s-8);height:var(--s-8);border-radius:50%;object-fit:cover}
.user-details{flex:1;min-width:0}
.user-name{font-weight:600;font-size:0.813rem;color:var(--text)}
.user-email{font-size:11px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

.overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(var(--s-0-5));z-index:25}
.overlay[hidden]{display:none}

#main{flex:1;min-width:0;display:flex;flex-direction:column}
.topbar{height:56px;display:flex;align-items:center;gap:var(--s-3);padding:0 var(--s-3);border-bottom:1px solid var(--b);background:rgba(0,0,0,.08);backdrop-filter:blur(var(--s-2));position:sticky;top:0;z-index:20}
.icon-btn{background:transparent;border:none;color:var(--text);font-size:var(--text-lg)}

section[data-route]{padding:var(--s-4);display:grid;gap:var(--s-3)}
.text-heading{font-size:20px;font-weight:700;color:var(--text-primary,var(--text-primary));margin:0 0 var(--s-4) 0;letter-spacing:-0.3px}
.main-pane{flex:1;overflow:auto;background:var(--bg-primary,var(--bg-primary))}

/* Slack-style channel hash */
.channel-hash{
  display:inline-block;
  width:1ch;
  margin-right:var(--s-2);
  font-weight:600;
  color:var(--text-secondary);
  opacity:.7;
}
.side-nav .nav-item.active .channel-hash{
  color:var(--text-primary);
  opacity:.9;
}

/* Hide old icon markup if exists */
.side-nav .nav-item img,
.side-nav .nav-item .icon{display:none !important;}

/* Utility classes */
.flex{display:flex;align-items:center;}
.gap-6{gap:var(--s-1-5);}
.gap-8{gap:var(--s-2);}
.stack-2>*+*{margin-top:var(--s-4);}
.text-secondary{color:var(--text-secondary,var(--alias-a1a1a1));}
.card-outlined{border:1px solid var(--border,var(--neutral-200));padding:var(--s-4);border-radius:var(--r-md,8px);}

/* Sidebar must never collapse */
#sidenav-list .nav-item,
#side-nav .nav-item {
  display: flex !important;
  align-items: center;
  width: 100%;
  text-align: left;
}

/* Prevent accidental hiding */
#sidenav-list .nav-item[hidden],
#side-nav .nav-item[hidden] {
  display: flex !important;
}

/* Ensure visibility even with aria-hidden */
#sidenav-list .nav-item[aria-hidden="true"],
#side-nav .nav-item[aria-hidden="true"] {
  display: flex !important;
  visibility: visible !important;
}

@media (max-width:1024px){
  .sidenav{position:fixed;left:0;top:0;bottom:0;width:88vw;max-width:360px;transform:translateX(-100%);transition:transform var(--norm) var(--ease);box-shadow:var(--shadow)}
  .sidenav.open{transform:translateX(0)}
}

.h1{font-size:1.375rem;font-weight:800}
.sub{color:var(--muted)}
.muted{color:var(--muted)}
.eyebrow{color:var(--muted);font-size:11px;text-transform:uppercase;letter-spacing:.08em}

 .legacy-card{background:var(--surface);border:1px solid var(--b);border-radius:var(--r);padding:var(--s-3-5);box-shadow:none;animation:pop var(--norm) var(--ease)}
.card-row{display:flex;justify-content:space-between;align-items:center;gap:var(--s-2)}
.card-title{font-weight:700}
.meta{color:var(--muted)}

.list{display:grid;gap:var(--s-2-5)}
.list-item{display:grid;grid-template-columns: 1fr auto;gap:var(--s-2);align-items:center;background:var(--surface);border:1px solid var(--b);border-radius:var(--r-sm);padding:var(--s-3)}
.list-title{font-weight:700}
.list-sub{color:var(--muted);font-size:0.813rem;margin-top:var(--s-0-5)}
.badges{display:flex;gap:var(--s-1-5);flex-wrap:wrap}
.badge{padding:0.188rem var(--s-2);border-radius: var(--r-md);font-size:0.75rem;color:var(--bg-tertiary)}
.badge.dev{background:var(--dev)} .badge.pub{background:var(--pub)} .badge.inv{background:var(--inv)} .badge.sp{background:var(--sp)}
.cta{display:flex;gap:var(--s-2);align-items:center}

.btn{border:none;border-radius:10px;padding:var(--s-2-5) var(--s-3);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;transition:transform var(--fast) var(--ease), background var(--fast) var(--ease), opacity var(--fast) var(--ease)}
.btn:hover{background:rgba(255,255,255,.1)}
.btn:active{transform:translateY(0)}
.btn:focus{outline:var(--bw-3) solid rgba(107,123,255,.6);outline-offset:var(--s-0-5)}
.btn-primary{background:var(--alias-0073b1);color:var(--text-primary)}
.btn-primary:hover{background:var(--alias-005885)}
.btn-primary:focus{outline:var(--bw-3) solid var(--alias-00a0dc);outline-offset:var(--s-0-5)}
.btn-secondary{background:transparent;color:var(--neutral-700);border:1px solid var(--neutral-500)}
.btn-secondary:hover{background:rgba(204,204,204,.1)}
.btn-secondary:focus{outline:var(--bw-3) solid var(--alias-888);outline-offset:var(--s-0-5)}
.btn-accent{background:var(--ok);color:var(--alias-0b1a0f)}
.btn-ghost{background:transparent;border:1px solid var(--b)}
.btn-danger{background:var(--err)}
.btn-small{padding:var(--s-1-5) var(--s-2);border-radius: var(--r-md);font-size:0.75rem}

/* Skip link for accessibility */
.skip-link{
  position:absolute;top:-40px;left:0;background:var(--text-on-accent);color:var(--text-primary);padding:var(--s-2) var(--s-4);
  z-index:100;border-radius:0 0 var(--s-2) 0;text-decoration:none;font-weight:600;
  transition:top var(--fast) var(--ease)
}
.skip-link:focus{top:0}

/* Screen reader only content */
.sr-only{
  position:absolute;width:var(--bw-1);height:var(--bw-1);padding:0;margin:calc(-1 * var(--bw-1));overflow:hidden;
  clip:rect(0,0,0,0);white-space:nowrap;border:0
}

/* Enhanced install  legacy-card */
.install-card{
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0.95);
  background:var(--surface);border:1px solid var(--b);border-radius:var(--r);
  padding:var(--s-6);text-align:center;max-width:var(--container-xs);width:90vw;
  box-shadow:var(--shadow);z-index:1000;opacity:0;pointer-events:none;
  transition:all var(--norm) var(--ease)
}
.install-card.visible{
  opacity:1;pointer-events:auto;transform:translate(-50%,-50%) scale(1)
}
.install-card.hidden{
  display:none
}
.install-content{outline:none}
.install-icon{width:64px;height:64px;border-radius: var(--r-lg);margin-bottom:16px}
.install-card h3{margin:0 0 var(--s-2);font-size:var(--text-lg);font-weight:700}
.install-card p{margin:0 0 var(--s-5);color:var(--muted)}
.install-card .btn{margin:4px var(--s-2)}

/* Production-safe invite panel styling (GPT-5 refined) */
.invite-panel {
  max-width:var(--container-sm);
  margin: var(--s-10) auto;
  padding: var(--s-5);
  background: var(--bg-2);
  border-radius: var(--r-md);
  text-align: center;
  animation: slideUp 0.3s ease-out
}

.invite-panel h2 {
  margin-bottom: var(--s-2-5);
  font-size: var(--s-6);
  font-weight: 700;
  color: var(--text)
}

.invite-panel p {
  margin-bottom: var(--s-5);
  color: var(--muted);
  line-height: 1.5
}

.invite-panel .btn {
  margin-top: var(--s-2)
}

/* Error state styling */
.invite-panel.invalid {
  border-color: var(--err);
  background: rgba(239, 68, 68, 0.05)
}

.invite-panel.invalid h2 {
  color: var(--err)
}

/* Success state styling */
.invite-panel.success {
  border-color: var(--ok);
  background: rgba(34, 197, 94, 0.05)
}

.invite-panel.success h2 {
  color: var(--ok)
}

/* Loading state styling */
.invite-panel.loading {
  border-color: var(--accent);
  background: rgba(107, 123, 255, 0.05)
}

.invite-panel.loading h2 {
  color: var(--accent)
}

.invite-panel.loading::after {
  content: '';
  display: block;
  width: var(--s-6);
  height: var(--s-6);
  margin: var(--s-4) auto 0;
  border: var(--s-0-5) solid var(--accent);
  border-top: var(--s-0-5) solid transparent;
  border-radius: 50%;
  animation: spin 1s linear infinite
}

/* Animations */
@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(var(--s-5))
  }
  to {
    opacity: 1;
    transform: translateY(0)
  }
}

@keyframes spin {
  to {
    transform: rotate(360deg)
  }
}

/* Party cards production polish (GPT-5 optimized) */
.events-header { margin-bottom: var(--s-5); }
.events-header h2 { margin: 0 0 var(--s-1) 0; font-size: var(--s-5); font-weight: 700; }
.events-grid { display: grid; gap: var(--s-3); }
.party-card {
  background: var(--surface, var(--bg-secondary));
  border: 1px solid var(--b, var(--border-primary));
  border-radius: var(--s-4);
  padding: var(--s-4);
  transition: border-color var(--fast) var(--ease), transform var(--fast) var(--ease);
}
.party-card:hover {
  border-color: rgba(107, 123, 255, 0.3);
  transform: translateY(calc(-1 * var(--bw-1)));
}
@media (prefers-reduced-motion: reduce) {
  .party-card:hover { transform: none; }
}
.party-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: var(--s-3);
}
.party-title {
  color: var(--text, var(--text-primary));
  margin: 0;
  font-weight: 600;
  font-size: var(--s-4);
  line-height: 1.3;
}
.party-category {
  font-size:var(--text-xs);
  padding: 3px var(--s-2);
  border-radius: var(--s-3);
  text-transform: uppercase;
  font-weight: 600;
  letter-spacing:0.031rem;
}
.party-details { margin-bottom: var(--s-4); }
.party-meta {
  display: flex;
  flex-direction: column;
  gap: var(--s-1);
  margin-bottom: var(--s-2);
}
.party-venue, .party-time {
  color: var(--muted, var(--text-secondary));
  font-size:0.813rem;
  display: flex;
  align-items: center;
  gap: var(--s-1-5);
}
.party-description {
  color: var(--muted, var(--text-secondary));
  font-size: var(--s-3-5);
  line-height: 1.4;
  margin: var(--s-2) 0 0 0;
}
.party-stats {
  color: var(--muted, var(--text-secondary));
  font-size: var(--s-3);
  margin-top: var(--s-2);
}
.party-actions {
  display: flex;
  gap: var(--s-2);
  flex-wrap: wrap;
}
.party-actions .btn {
  flex: 1;
  min-width: 0;
  font-size:0.813rem;
  padding: var(--s-2) var(--s-3);
}
.btn-success {
  background: var(--ok, var(--success));
  border-color: var(--ok, var(--success));
  color: var(--alias-0b1a0f);
}
.btn-success:hover {
  background: var(--neutral-100);
  border-color: var(--neutral-100);
}

/* Enhanced empty/loading/error states */
.empty-state, .loading-state, .error-state {
  text-align: center;
  padding: var(--s-12) var(--s-6);
  border-radius: var(--s-3);
  background: var(--surface, var(--neutral-200));
  border: 1px solid var(--b, var(--alias-383d45));
  margin: var(--s-5) 0;
}
.empty-state-icon, .error-state-icon {
  font-size: var(--s-12);
  margin-bottom: var(--s-4);
  display: block;
}
.empty-state-title, .error-state-title {
  font-size:var(--text-lg);
  font-weight: 600;
  margin: 0 0 var(--s-2) 0;
}
.empty-state-title { color: var(--text, var(--text-primary)); }
.error-state-title { color: var(--err, var(--error)); }
.empty-state-message, .error-state-message, .loading-message {
  font-size: var(--s-3-5);
  line-height: 1.4;
  color: var(--muted, var(--alias-9ea2aa));
  margin: 0 0 var(--s-5) 0;
}

/* iOS install hint */
.install-ios-hint {
  position: fixed;
  top: var(--s-5);
  left: 50%;
  transform: translateX(-50%);
  background: var(--accent, var(--color-primary-dark));
  color: white;
  padding: var(--s-2) var(--s-4);
  border-radius: var(--s-5);
  font-size:0.813rem;
  font-weight: 500;
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: 1000;
  pointer-events: none;
}
.install-ios-hint.visible {
  opacity: 1;
  pointer-events: auto;
}

.hint{font-size:0.813rem;color:var(--muted);margin-bottom:var(--s-2)}
.ios-chip{display:inline-block;border:1px solid var(--b);border-radius: var(--r-md);padding:var(--s-0-5) var(--s-1-5)}

.sync-grid{display:grid;gap:var(--s-2-5)}
.sync-item{display:flex;align-items:center;gap:var(--s-2-5);background:var(--surface);border:1px solid var(--b);border-radius:var(--r-sm);padding:var(--s-3)}
.sync-item .grow{flex:1}
.sync-actions{display:flex;gap:var(--s-2)}
.sync-success{display:flex;align-items:center;gap:var(--s-2);background:rgba(34,197,94,.12);border:1px solid rgba(34,197,94,.35);color:var(--success);border-radius: var(--r-lg);padding:var(--s-2) var(--s-3)}

.sheet{position:fixed;left:0;right:0;bottom:0;background:var(--bg-2);border-top:1px solid var(--b);border-radius: var(--r-xl) var(--s-4) 0 0;padding:var(--s-3) var(--s-4);transform:translateY(var(--s-4));opacity:0;pointer-events:none}
.sheet.show{transform:translateY(0);opacity:1;pointer-events:auto;transition:transform var(--norm) var(--ease),opacity var(--norm) var(--ease)}
.drag{width:var(--s-10);height:var(--s-1);background:rgba(255,255,255,.18);border-radius: var(--r-xs);margin:var(--s-1-5) auto var(--s-2-5)}

.inv-head{display:flex;justify-content:space-between;align-items:end}
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:var(--s-2)}
.stat{background:var(--surface);border:1px solid var(--b);border-radius: var(--r-lg);padding:var(--s-2-5);text-align:center}
.val{font-weight:800;font-size:var(--text-lg)}.lab{display:block;font-size:0.75rem;color:var(--muted);margin-top:var(--s-0-5)}
.trophy-list{list-style:none;margin:0;padding:0;max-height:58vh;overflow:auto;display:grid;gap:var(--s-2)}
.trophy-row{display:flex;align-items:center;gap:var(--s-2-5);background:var(--surface);border:1px solid var(--b);border-radius: var(--r-lg);padding:var(--s-2-5) var(--s-3)}
.trophy-row .avatar{width:var(--s-10);height:var(--s-10);border-radius:50%;object-fit:cover;border:1px solid rgba(255,255,255,.08)}
.badge-ok{color:var(--success);background:rgba(34,197,94,.12);border:1px solid rgba(34,197,94,.35);border-radius: var(--r-pill);padding:var(--s-1) var(--s-2);font-size:0.75rem;margin-left:auto}
.badge-wait{color:var(--muted);background:rgba(165,167,173,.1);border:1px solid rgba(165,167,173,.35);border-radius: var(--r-pill);padding:var(--s-1) var(--s-2);font-size:0.75rem;margin-left:auto;animation:softPulse 2.2s ease-in-out infinite}
.bonus{display:flex;align-items:center;gap:var(--s-2);background:linear-gradient(180deg, rgba(255,215,0,.15), rgba(255,215,0,.08));border:1px solid rgba(255,215,0,.35);border-radius: var(--r-lg);padding:var(--s-2-5) var(--s-3)}

.center{text-align:center}
.toast{position:fixed;left:50%;bottom:4.5rem;transform:translateX(-50%);background:rgba(21,21,26,.96);border:1px solid var(--b);color:var(--text);padding:var(--s-2) var(--s-3);border-radius: var(--r-lg);z-index:2147483647}

@keyframes pop{from{opacity:0;transform:translateY(var(--s-2))}to{opacity:1;transform:translateY(0)}}
@keyframes softPulse{0%{opacity:.7}50%{opacity:1}100%{opacity:.7}}
.bump{animation: bump .32s var(--ease)}
@keyframes bump{0%{transform:scale(.92)}60%{transform:scale(1.08)}100%{transform:scale(1)}}

.sr-only{position:absolute;width:var(--bw-1);height:var(--bw-1);padding:0;margin:calc(-1 * var(--bw-1));overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
:focus-visible{outline:2px solid var(--accent);outline-offset:var(--s-0-5)}
@media (prefers-reduced-motion: reduce){
  *{animation:none!important;transition:none!important}
}

/* Slack-style channel look */
.side-nav .nav-item { display:flex; gap:var(--s-2); align-items:center; }
.side-nav .nav-item .hash {
  width:var(--s-4-5); text-align:center; font-weight:700; opacity:.7;
}
.side-nav .nav-item .label { white-space:nowrap; }
.side-nav .nav-item.active .hash { opacity:1; }