
[1;36m=== DESIGN SYSTEM AUDIT ===[0m
Timestamp: Sat Aug 16 06:12:14 UTC 2025
Repository: /workspaces/conference-party-microservice


[1;36m=== Environment Probe ===[0m

[1;36m=== Environment Probe ===[0m
ROOT: /workspaces/conference-party-microservice
FE src: /workspaces/conference-party-microservice/frontend/src
Prod base: https://conference-party-app.web.app
[1;32m✔ frontend/dist exists[0m
[1;32m✔ public/ directory exists (main serving directory)[0m
  Main files:
    /workspaces/conference-party-microservice/public/test-calendar-buttons.html (3.8K)
    /workspaces/conference-party-microservice/public/test-gcal-clean.html (6.8K)
    /workspaces/conference-party-microservice/public/test-gcal-oauth.html (9.5K)
    /workspaces/conference-party-microservice/public/test-simple-calendar.html (6.2K)
    /workspaces/conference-party-microservice/public/test-smart-calendar.html (8.2K)
  JS files:
    calendar-view.js (4.0K)
    add-to-calendar-wrapper.js (4.0K)
    events-controller.js (4.0K)
    kill-sw.js (4.0K)
    offline-search.js (48K)

Commit: 16caadb 2025-08-16  fix: eliminate all remaining hardcoded hex colors - complete token migration
Branch: fix/home-style-polish

Testing production endpoints...
[1;32m✔ Fetched https://conference-party-app.web.app[0m
  Index size: 4.0K
  Assets found:
    href="/assets/css/base.css"
    href="/assets/css/spacing-tokens.css"
    href="/assets/css/tokens/color-tokens.css"
    href="/assets/css/components/buttons.css"
    href="/assets/css/components/cards.css"
[1;32m✔ API health check passed[0m
  Response: 
<html><head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>404 Page not

Design Token Files:
[1;32m✔ spacing-tokens.css exists (78 lines)[0m
[1;31m✘ color-tokens.css missing[0m


[1;36m=== Environment Summary ===[0m
📁 Project Structure:
  - Frontend source: /workspaces/conference-party-microservice/frontend/src
  - Public assets: /workspaces/conference-party-microservice/public
  - CSS files: 57
  - JS files: 200

🌐 Production Status:
  - Site: ✅ Online
  - API: ✅ Healthy
[1;32m✔ Completed Environment Probe[0m

[1;36m=== Layout & Navigation ===[0m

[1;36m=== Layout & Sidebar Audit ===[0m
📐 Grid Layout Analysis:
[1;32m✔ Found grid-template-columns in 50 files:[0m
  • frontend/src/apm-dashboard.html
    Line 25:            grid-template-columns: 250px 1fr;
  • frontend/src/assets/css/calendar-buttons.css
    Line 1:.cal-menu{display:none;grid-template-columns:1fr;gap:var(--s-2);padding:var(--s-3)}
  • frontend/src/assets/css/styles.css
    Line 142:.list-item{display:grid;grid-template-columns: 1fr auto;gap:var(--s-2);align-items:center;background:var(--surface);border:1px solid var(--b);border-radius:var(--r-sm);padding:var(--s-3)}
  • frontend/src/assets/css/stack.css
    Line 57:  grid-template-columns: auto 1fr auto;
  • frontend/src/assets/css/channel-row.css
    Line 5:  grid-template-columns:1.75rem 1fr 1.25rem;
  • frontend/src/assets/css/components/cards.css
    Line 112:  grid-template-columns: repeat(auto-fill, minmax(280, 1fr));
  • frontend/src/assets/css/z-overrides.css
    Line 13:  grid-template-columns: max-content minmax(0, 1fr) !important;
  • frontend/src/assets/css/hero-cards.css
    Line 43:  grid-template-columns:repeat(auto-fill, minmax(var(--container-xs), 1fr));
  • frontend/src/assets/css/events-cards.css
    Line 54:  grid-template-columns: 1fr;
  • frontend/src/assets/css/account.css
    Line 19:.stats { display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:12px; margin:8px 0 var(--s-3); }
[1;33m⚠ Issues found in Layout & Navigation[0m

[1;36m=== Cards System ===[0m

[1;36m=== Cards System Audit ===[0m
🃏 Card Component Analysis:
[1;32m✔ Found 9 card-related CSS files:[0m
  • frontend/src/assets/css/components/cards.css (4.0K)
  • frontend/src/assets/css/hero-cards.css (8.0K)
  • frontend/src/assets/css/events-cards.css (8.0K)
  • frontend/src/assets/css/cards-parties.css (4.0K)
  • frontend/src/assets/css/cards.css (4.0K)
  • frontend/src/assets/css/cards-final.css (4.0K)
  • frontend/src/assets/css/cards-hero.css (4.0K)
  • frontend/src/assets/css/event-cards.css (4.0K)
  • frontend/src/assets/css/party-cards.css (4.0K)

📋 Card Class Usage:
[1;32m✔ vcard class usage: 170 instances[0m
[1;32m✔ General card classes: 329 instances[0m

🏗️ Card Structure Patterns:
[1;32m✔ Flex-based card layouts: 21 definitions[0m
[1;32m✔ No fixed heights on cards (good - allows flexible content)[0m

📐 Card Body Flexibility:
[1;33m⚠ Card bodies don't use flex-grow (may cause layout issues)[0m

🎯 Card Grid Layouts:
[1;32m✔ Card grid/list containers found: 12[0m
[1;32m✔ Responsive card layouts: 6 media queries[0m

✨ Card Interactions:
  • Hover effects: 13 definitions

🔘 Card Actions:
[1;32m✔ Card action areas: 49 references[0m
  Action types found:
    • Save/Bookmark: 280
    • Sync/Calendar: 1078

⏳ Loading States:
[1;32m✔ Skeleton/loading states: 26 definitions[0m

♿ Card Accessibility:
[1;32m✔ Semantic roles on cards: 1[0m
[1;32m✔ Proper heading hierarchy in cards: 9[0m

📊 Card System Summary:
  ✅ Good practices:
    • Flexible card layouts with flexbox
    • No fixed heights (content-flexible)
    • Responsive card designs
    • Interactive hover states

  ⚠️  Improvements needed:
[1;33m⚠ Issues found in Cards System[0m

[1;36m=== Design Tokens ===[0m

[1;36m=== Design Tokens Audit (spacing/radius/shadow) ===[0m
📏 Token Usage Analysis:
[1;32m✔ Design tokens used in 933 CSS files[0m
  Token usage breakdown:
    • Spacing tokens: 794 instances
    • Radius tokens: 127 instances
    • Shadow tokens: 29 instances

🚫 Raw Pixel Values (common spacing):
[1;32m✔ No raw spacing px values found[0m

🔲 Border Radius Values:
[1;32m✔ All border-radius values use tokens[0m

🎨 Color Values:
[1;32m✔ No hardcoded hex colors found[0m

📊 Token Compliance Summary:
  ✅ Tokens properly defined in:
    • spacing-tokens.css

  ⚠️  Areas needing attention:

📐 Line-height Analysis:
[1;33m⚠ 0
0 line-heights with px units (prefer unitless)[0m
[1;32m✔ Completed Design Tokens[0m

[1;36m=== Maps Integration ===[0m

[1;36m=== Maps Integration Audit ===[0m
🗺️  Google Maps API Analysis:
[1;33m⚠ No Maps script tag found in production index[0m

🔑 API Key Security:
[1;31m✘ Exposed API keys found in source:[0m
  • frontend/src/index.html:32
    Key: AIzaSyD5Zj...otgc (masked)
  • frontend/src/maps.html:135
    Key: AIzaSyD5Zj...otgc (masked)
  • frontend/src/js/panels/mount-map.js:89
    Key: AIzaSyD5Zj...otgc (masked)

📍 Map Implementation:
[1;32m✔ Found 2 map initialization(s)[0m
[1;33m⚠ Both mapId and styles used (cloud styles override local)[0m
  MapId usage:
    • /workspaces/conference-party-microservice/frontend/src/js/panels/mount-map.js:49:    mapId: 'conference-party-map'
  Styles usage:
    • /workspaces/conference-party-microservice/frontend/src/js/services/maps-loader.js:106:    styles: getMapStyles()
    • /workspaces/conference-party-microservice/frontend/src/js/dom-optimizer.js:338:                styles: {

🎯 Marker Implementation:
[1;32m✔ Using AdvancedMarkerElement (2 instances) - modern approach[0m
[1;33m⚠ Still using legacy Marker (1 instances) - consider migrating[0m
  • frontend/src/js/map-init.js:24

📊 Maps Summary:
  Configuration:
    ✅ Using modern AdvancedMarkerElement

  Potential Issues:
    ⚠️  No Maps script in production
    ❌ Exposed API keys in source
    ⚠️  Legacy markers still in use
[1;32m✔ Completed Maps Integration[0m

[1;36m=== Calendar Integration ===[0m

[1;36m=== Calendar Integration Audit ===[0m
📅 Backend Calendar Endpoints:
[1;32m✔ Found 4 calendar endpoint references in backend:[0m
  • functions/src/calendar/google.ts:16
    Endpoint: /api/calendar/google/callback
  • functions/src/index.ts:127
    Endpoint: /api/googleCalendar/*
  • functions/src/googleCalendar/router.ts:64
    Endpoint: /api/googleCalendar/google/callback`;
  • functions/src/googleCalendar/router.ts:151
    Endpoint: /api/googleCalendar/google/callback`;

📱 Frontend Calendar Integration:
[1;32m✔ Calendar-related files found:[0m
  • frontend/src/js/add-to-calendar-wrapper.js (4.0K)
  • frontend/src/js/calendar.js (32K)
  • frontend/src/js/components/calendar-button.js (4.0K)
  • frontend/src/js/calendar-click-handler.js (4.0K)
  • frontend/src/js/calendar-integrated.js (8.0K)
  • frontend/src/js/calendar-mtm.js (4.0K)
  • frontend/src/js/calendar-delegation.js (8.0K)
  • frontend/src/js/services/calendar-client.js (8.0K)
  • frontend/src/js/services/gcal-lite.js (12K)
  • frontend/src/js/services/gcal-backend.js (12K)
  • frontend/src/js/services/calendarSync.js (4.0K)
  • frontend/src/js/services/gcal.js (4.0K)
  • frontend/src/js/services/gcal-clean.js (8.0K)
  • frontend/src/js/services/gcal-minimal.js (4.0K)
  • frontend/src/js/services/calendar-smart.js (8.0K)
  • frontend/src/js/wiring/wire-calendar.js (4.0K)
  • frontend/src/js/calendar (16K)
  • frontend/src/js/calendar-handler.js (4.0K)
  • frontend/src/js/calendar-add-simple.js (4.0K)
  • frontend/src/js/calendar-clean.js (8.0K)
  • frontend/src/js/gcal-hooks.js.bak (4.0K)
  • frontend/src/js/calendar-add-handler.js (4.0K)
  • frontend/src/js/panels/mount-calendar.js (4.0K)
  • frontend/src/js/panels/providers-calendar.js (4.0K)
  • frontend/src/js/wire/calendar-buttons.js (8.0K)
  • frontend/src/js/calendar-simple.js (12K)
  • frontend/src/js/calendar-polish.js (8.0K)
  • frontend/src/js/gcal-hooks.js (8.0K)
  • frontend/src/js/calendar-strip.js (4.0K)
  • frontend/src/js/wire-calendar-buttons.js (4.0K)
  • frontend/src/js/ui/add-to-calendar-clean.js (4.0K)
  • frontend/src/js/ui/add-to-calendar.js (4.0K)
  • frontend/src/js/calendar-sync.js (4.0K)
  • frontend/src/js/global-calendar-handler.js (4.0K)
  • frontend/src/js/calendar-integration.js (16K)
  • frontend/src/js/smart-calendar.js (12K)

🔗 Calendar Provider Services:
  Provider references:
    • Google Calendar: 116 references
    • iCal/ICS export: 557 references
    • Outlook: 39 references

🔐 OAuth Configuration:
[1;32m✔ OAuth flow implementation found (96 references)[0m

🌐 Production Endpoint Testing:
Testing calendar endpoints:
  https://us-central1-conference-party-app.cloudfunctions.net/api/api/gcal/connect
    Response: HTTP/2 404 
  https://us-central1-conference-party-app.cloudfunctions.net/api/api/googleCalendar/status
    Response: HTTP/2 404 
  https://us-central1-conference-party-app.cloudfunctions.net/api/api/calendar/status
    Response: HTTP/2 404 

🎯 Calendar Button Implementation:
[1;32m✔ Calendar button implementation found (51 references)[0m
  Event data attributes found:
    • /workspaces/conference-party-microservice/frontend/src/js/components/cards.js:42:                data-title="${escapeHTML(evt.title)}"
    • /workspaces/conference-party-microservice/frontend/src/js/components/cards.js:45:                data-start="${evt.start || ''}"
    • /workspaces/conference-party-microservice/frontend/src/js/components/cards.js:46:                data-end="${evt.end || ''}">Add to Calendar</button>

📊 Calendar Integration Summary:
  ✅ Implemented:
    • Backend calendar endpoints
    • Frontend calendar services
    • Google Calendar integration
    • Calendar button components

  ⚠️  Missing/Issues:
[1;33m⚠ Issues found in Calendar Integration[0m

[1;36m=== API & Data ===[0m

[1;36m=== Parties API Audit ===[0m
🎉 Testing Parties API Endpoint:
  GET https://us-central1-conference-party-app.cloudfunctions.net/api/parties?conference=gamescom2025

[1;32m✔ Successfully fetched parties data (272 bytes)[0m
[1;31m✘ Invalid JSON response[0m
  First 500 chars:
    
    <html><head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <title>404 Page not found</title>
    </head>
    <body text=#000000 bgcolor=#ffffff>
    <h1>Error: Page not found</h1>
    <h2>The requested URL was not found on this server.</h2>
    <h2></h2>
    </body></html>

🔄 Testing Other API Endpoints:
  GET https://us-central1-conference-party-app.cloudfunctions.net/api/health
[1;33m⚠ Health endpoint returns 404[0m
  GET https://us-central1-conference-party-app.cloudfunctions.net/api/sync
[1;32m✔ Sync endpoint responded (272 bytes)[0m

📊 API Summary:
  Endpoints tested:
    • /parties - Main data endpoint
    • /health - Service health check
    • /sync - Data synchronization

🔐 Security Check:
[1;32m✔ No obvious sensitive data exposed[0m
[1;32m✔ Completed API & Data[0m

[1;36m=== Accessibility ===[0m

[1;36m=== Accessibility Audit ===[0m
🎯 Interactive Elements:
  Elements found:
    • <button> elements: 632
    • <a> links: 37
[1;33m⚠ Buttons styled as links (consider using <a> for navigation):[0m
  • frontend/src/referral.html:142
  • frontend/src/sharing-test.html:238
  • frontend/src/index-production.html:209

♿ ARIA Attributes:
  ARIA usage:
[1;32m✔ aria-label: 45 instances[0m
    • aria-labelledby: 4 instances
    • aria-describedby: 3 instances

  State indicators:
    ✓ aria-pressed: 16 (toggle buttons)

📝 Semantic HTML:
  Heading hierarchy:
    • <h1>: 60
    • <h2>: 101
    • <h3>: 192
[1;32m✔ Semantic <nav> elements: 8[0m
[1;32m✔ Semantic <main> element present[0m

🖼️ Image Accessibility:
[1;33m⚠ 2 of 13 images missing alt attributes[0m

⌨️ Keyboard Navigation:
[1;32m✔ tabindex usage appears correct (0 or -1 only)[0m
[1;32m✔ Focus styles defined (24 instances)[0m

🎨 Color Contrast:
  Color usage:
    • Text colors defined: 355
    • Background colors defined: 87
    • Note: Manual contrast testing recommended

📱 Mobile/Touch Accessibility:
[1;33m⚠ Check touch target sizes (minimum 44px recommended)[0m

📊 Accessibility Summary:
  ✅ Good practices:
    • ARIA labels in use
    • Semantic navigation elements
    • Focus styles defined

  ⚠️  Areas for improvement:
[1;33m⚠ Issues found in Accessibility[0m

[1;36m=== Performance ===[0m

[1;36m=== Performance & Bundle Audit ===[0m
📦 Bundle Analysis:
  Distribution bundles:
    • init-app.js: 20K
    • settings-panel-UNYSQV2R.js: 8.0K
    • stack.js: 4.0K
    • router-stack.js: 4.0K
    • me-panel-DDMWH2UI.js: 4.0K
    • main.js: 4.0K
    • contacts-panel-COOBU7OX.js: 4.0K
[1;32m✔ No JavaScript bundles exceed 300KB[0m

🌐 Production Performance:
[1;32m✔ Production index fetched: 4.0K[0m
  Resources loaded:
    • CSS files: 10
    • JS files: 5

🔍 Duplicate Resource Check:
[1;33m⚠ Issues found in Performance[0m

[1;36m=== Code Duplication ===[0m

[1;36m=== Duplication & Conflicts Audit ===[0m
🔄 Checking for Duplicate Code Patterns:

📝 CSS Selector Duplication:
[1;33m⚠ Found 23 duplicate CSS selectors:[0m
    .badge { 
    .btn {
    .btn { 
    .btn-primary {
    .card-grid {
    .empty-state {
    .event-actions {
    .event-card {
    .event-meta {
    .ftue-progress {

🔧 JavaScript Function Duplication:
[1;33m⚠ Found 11 duplicate function names:[0m
    • downloadICS
    • el
    • emptyState
    • escapeHtml
    • hash
    • renderAccount
    • renderConnect
    • showToast
    • toICSDate
    • toast

🌐 API Endpoint Duplication:
[1;32m✔ No duplicate API endpoints (verb + path)[0m
  Total unique endpoints: 40

📦 Exported Function Collisions:
[1;32m✔ No duplicate exported function names[0m

🧩 Component File Duplication:
[1;32m✔ No duplicate component filenames[0m

🎨 Color Definition Duplication:
[1;32m✔ No duplicate color variable definitions[0m

🏷️ HTML ID Duplication:
[1;31m✘ Found 1 duplicate HTML IDs (must be unique):[0m
    • #app

📂 CSS File Organization:
[1;33m⚠ Multiple calendar CSS files (6) - review for duplication[0m
    • /workspaces/conference-party-microservice/frontend/src/assets/css/calendar-button-single.css
    • /workspaces/conference-party-microservice/frontend/src/assets/css/calendar-buttons.css
    • /workspaces/conference-party-microservice/frontend/src/assets/css/calendar-fit.css
    • /workspaces/conference-party-microservice/frontend/src/assets/css/calendar-modal.css
    • /workspaces/conference-party-microservice/frontend/src/assets/css/calendar-uniform.css
    • /workspaces/conference-party-microservice/frontend/src/assets/css/calendar.css

📥 Import Statement Analysis:

📊 Duplication Summary:
  Code Quality Metrics:
    ✅ No duplicate API endpoints

  Potential Issues:
    ⚠️  Duplicate CSS selectors found
    ⚠️  Duplicate function names
    ❌ Duplicate HTML IDs (critical)
[1;32m✔ Completed Code Duplication[0m

[1;36m=== Token Compliance ===[0m
Checking token compliance...

📏 Spacing Tokens:
[1;33m⚠ --s-1 not used[0m
[1;33m⚠ --s-2 not used[0m
[1;33m⚠ --s-3 not used[0m
[1;33m⚠ --s-4 not used[0m
[1;33m⚠ --s-5 not used[0m
[1;33m⚠ --s-6 not used[0m
[1;33m⚠ --s-7 not used[0m
[1;33m⚠ --s-8 not used[0m

🎨 Color Tokens:
[1;33m⚠ --color-primary not used[0m
[1;33m⚠ --bg-primary not used[0m
[1;33m⚠ --text-primary not used[0m
[1;33m⚠ --nav-bg not used[0m
[1;33m⚠ --nav-text not used[0m

⚠️  Hardcoded Values:
[1;33m⚠ Issues found in Token Compliance[0m

[1;36m=== CSS Analysis ===[0m
Analyzing CSS architecture...

📁 CSS Files:
[1;32m✔ Found 57 CSS files[0m

Main stylesheets:
  - account.css (44 lines, 1825 bytes)
  - animations.css (172 lines, 3686 bytes)
  - app-shell.css (86 lines, 1912 bytes)
  - base.css (62 lines, 946 bytes)
  - button-secondary.css (61 lines, 1329 bytes)
  - calendar-button-single.css (54 lines, 1318 bytes)
  - calendar-buttons.css (6 lines, 973 bytes)
  - calendar-fit.css (10 lines, 488 bytes)
  - calendar-modal.css (234 lines, 4923 bytes)
  - calendar-uniform.css (116 lines, 3928 bytes)
  - calendar.css (7 lines, 396 bytes)
  - cards-final.css (129 lines, 2406 bytes)
  - cards-hero.css (167 lines, 3163 bytes)
  - cards-parties.css (23 lines, 1761 bytes)
  - cards.css (19 lines, 1534 bytes)
  - channel-row.css (25 lines, 1195 bytes)
  - color-tokens.old.css (133 lines, 4290 bytes)
  - components.css (130 lines, 2196 bytes)
  - contacts-permission.css (174 lines, 3638 bytes)
  - email-sync-popup.css (214 lines, 5677 bytes)
  - emailSyncPrompt.css (337 lines, 6702 bytes)
  - event-cards.css (97 lines, 1992 bytes)
  - events-cards.css (224 lines, 7513 bytes)
  - events-ftue.css (188 lines, 3376 bytes)
  - events.css (134 lines, 5595 bytes)
  - header-actions.css (20 lines, 411 bytes)
  - hero-cards.css (86 lines, 4583 bytes)
  - home.css (175 lines, 3449 bytes)
  - hotspots.css (210 lines, 5136 bytes)
  - install.css (120 lines, 2419 bytes)
  - invites.css (97 lines, 3509 bytes)
  - layout.css (35 lines, 881 bytes)
  - main.css (696 lines, 13766 bytes)
  - nav.css (186 lines, 3760 bytes)
  - panel-stack.css (68 lines, 1615 bytes)
  - party-cards.css (42 lines, 1528 bytes)
  - pin-button.css (62 lines, 1155 bytes)
  - sidebar.css (142 lines, 2914 bytes)
  - slot-heights.css (47 lines, 1218 bytes)
  - spacing-tokens.css (78 lines, 2910 bytes)
  - stack.css (209 lines, 5339 bytes)
  - styles.css (465 lines, 18151 bytes)
  - theme-unified.css (53 lines, 3260 bytes)
  - theme.css (34 lines, 1518 bytes)
  - toast.css (165 lines, 3187 bytes)
  - tokens.css (105 lines, 4017 bytes)
  - z-overrides.css (105 lines, 2848 bytes)

🏗️  BEM Methodology:
[1;32m✔ BEM naming found:[0m
  - Elements (__): 0
0
  - Modifiers (--): 2190

🎨 CSS Variables:
[1;32m✔ Variable definitions: 350[0m
[1;32m✔ Variable usage: 1935[0m

📱 Responsive Design:
[1;32m✔ Media queries found: 43[0m

🔍 Code Quality:
[1;33m⚠ Duplicate selectors found:[0m
  -     .btn-sync 
  -     .email-sync-popup 
  -     .popup-text 
  -   .card-grid 
  -   .contact-sheet 
[1;33m⚠ High !important usage: 31[0m

📋 Organization:
[1;33m⚠ Token files not properly organized[0m
[1;32m✔ Component-specific CSS files: 16[0m
[1;32m✔ Completed CSS Analysis[0m

[1;36m=== Component Review ===[0m
Reviewing component structure...

📦 JavaScript Structure:
[1;32m✔ Components directory exists (6 files)[0m
  Components:
    - cards.js
    - calendar-button.js
    - channel-row.js
    - map-integration.js
    - VirtualizedEventList.js
[1;32m✔ Views directory exists (0 files)[0m
  Views:
[1;32m✔ Services directory exists (18 files)[0m

🎨 UI Utilities:
[1;32m✔ UI utilities directory exists (16 files)[0m
  - homeViews.js
  - provenance.js
  - skeleton.js
  - connectionCard.js
  - equalize-cards.js

🏗️  Component Patterns:
[1;32m✔ Card pattern implemented (JS: 6, CSS: 9)[0m
[1;32m✔ Sidebar components (JS: 3, CSS: 1)[0m
[1;32m✔ Modal/Dialog components: 1[0m

📦 Module Patterns:
[1;32m✔ ES6 modules in use (imports: 170, exports: 355)[0m

✅ Consistency Checks:
  File naming:
    - Kebab-case files: 139
    - CamelCase files: 27
[1;32m✔ Test files found: 62[0m

📊 Component Summary:
  - Total JS files: 200
  - Total CSS files: 57
  - Avg lines per JS: 500
[1;32m✔ Completed Component Review[0m

[1;36m=== SUMMARY ===[0m

Design System Audit Report
==========================
Date: Sat Aug 16 06:12:18 UTC 2025
Repository: conference-party-microservice

📊 Statistics:
  - CSS Files: 94
  - JS Files: 233
  - HTML Files: 22

🎨 Design Tokens:
[1;32m✔ Spacing tokens defined[0m
[1;31m✘ Missing color tokens[0m

🔍 Key Findings:
[1;33m⚠ 246 hardcoded px values found (should use tokens)[0m
[1;32m✔ BEM methodology in use (2292 instances)[0m

📁 Component Structure:
[1;32m✔ 6 components found[0m
[1;32m✔ 0 views found[0m

✅ Recommendations:
  1. Continue using design tokens for all spacing and colors
  2. Replace remaining hardcoded values with tokens
  3. Maintain BEM naming convention for new components
  4. Keep component/view separation clear
  5. Document token usage in component files

Report saved to: /workspaces/conference-party-microservice/design-audit-20250816-061214.txt


[1;36m=== AUDIT COMPLETE ===[0m

[1;36m=== 1) Files in scope ===[0m
✅ JS at /workspaces/conference-party-microservice/frontend/src/js
• Router:
• Calendar modules:
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:34:    googleCalendarId: 'primary'
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:58:                     value="${state.googleCalendarId || 'primary'}"
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:69:              Calendar ID (use 'primary' for main calendar)
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:77:              Sign in with Google to enable calendar mirroring
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:108:      const calendarId = (cal.value || 'primary').trim();
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:109:      const res = await post('/mirror', { enabled, calendarId });
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:112:        state.googleCalendarId = calendarId;
/workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:150:        state.googleCalendarId = res.googleCalendarId || 'primary';
/workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:13:    if (ev.data?.source === 'gcal') {
/workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:17:        // Success - refresh calendar UI
/workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:34:    // Update any calendar buttons to show connected state
/workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:35:    document.querySelectorAll('[data-action="add-to-calendar"]').forEach(btn => {
• Map modules:
/workspaces/conference-party-microservice/frontend/src/js/hotspots-view.js:171:        // open native maps — stays simple & cross-platform
/workspaces/conference-party-microservice/frontend/src/js/hotspots-view.js:172:        const url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`;
/workspaces/conference-party-microservice/frontend/src/js/utils/lazy-load.js:161:lazyLoader.register('maps', () => import('../maps.js?v=b023'));
/workspaces/conference-party-microservice/frontend/src/js/utils/performance-optimized.js:113:    // Load maps when map container visible
/workspaces/conference-party-microservice/frontend/src/js/utils/performance-optimized.js:114:    loadOnVisible('#map-container', 'maps');
/workspaces/conference-party-microservice/frontend/src/js/components/map-integration.js:6:import { ensureMapsReady, initializeMap, createMarker } from '../services/maps-loader.js';
/workspaces/conference-party-microservice/frontend/src/js/components/map-integration.js:48:    const bounds = new google.maps.LatLngBounds();
/workspaces/conference-party-microservice/frontend/src/js/components/map-integration.js:104: * @param {google.maps.Map} map - Map instance
/workspaces/conference-party-microservice/frontend/src/js/components/map-integration.js:105: * @param {google.maps.marker.AdvancedMarkerElement} marker - Marker instance
/workspaces/conference-party-microservice/frontend/src/js/components/map-integration.js:113:  const infoWindow = new google.maps.InfoWindow({
/workspaces/conference-party-microservice/frontend/src/js/components/map-integration.js:141: * @param {google.maps.Map} map - Map instance
/workspaces/conference-party-microservice/frontend/src/js/components/map-integration.js:192:  const url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`;

[1;36m=== 2) Selector ↔ Handler mapping (static scan) ===[0m

▶ .btn-add-to-calendar
⚠️  No occurrences found in source
✅ Delegated handler context:
    - /workspaces/conference-party-microservice/frontend/src/js/live-editor.js:1036:                    <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/analytics-privacy.js:357:                    <button onclick="this.closest('[role=modal]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:934:                <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1030:                <button onclick="this.closest('[style*=fixed]').remove(); standaloneLiveEditor.activateEditor();" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1039:                <button onclick="this.closest('[style*=fixed]').remove();" style="
• Related functions nearby (sample):
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:43:        <button id="mtm-disconnect">Disconnect</button>
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:96:    document.getElementById('mtm-disconnect')?.addEventListener('click', async () => {
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:97:      const res = await post('/disconnect');
    - /workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:104:    // This event can be dispatched by startOAuth to use message-based
    - /workspaces/conference-party-microservice/frontend/src/js/add-to-calendar-wrapper.js:5:export async function addToCalendar(ev) {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:191:                this.renderCalendarView();
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:226:                        ${events.map(event => this.renderCalendarEventCard(event)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:235:    renderCalendarView() {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:252:                ${weekDays.map(day => this.renderCalendarDay(day)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:290:    renderCalendarEventCard(event) {

▶ .btn-cal-google
⚠️  No occurrences found in source
✅ Delegated handler context:
    - /workspaces/conference-party-microservice/frontend/src/js/live-editor.js:1036:                    <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/analytics-privacy.js:357:                    <button onclick="this.closest('[role=modal]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:934:                <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1030:                <button onclick="this.closest('[style*=fixed]').remove(); standaloneLiveEditor.activateEditor();" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1039:                <button onclick="this.closest('[style*=fixed]').remove();" style="
• Related functions nearby (sample):
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:43:        <button id="mtm-disconnect">Disconnect</button>
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:96:    document.getElementById('mtm-disconnect')?.addEventListener('click', async () => {
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:97:      const res = await post('/disconnect');
    - /workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:104:    // This event can be dispatched by startOAuth to use message-based
    - /workspaces/conference-party-microservice/frontend/src/js/add-to-calendar-wrapper.js:5:export async function addToCalendar(ev) {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:191:                this.renderCalendarView();
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:226:                        ${events.map(event => this.renderCalendarEventCard(event)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:235:    renderCalendarView() {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:252:                ${weekDays.map(day => this.renderCalendarDay(day)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:290:    renderCalendarEventCard(event) {

▶ .btn-cal-outlook
⚠️  No occurrences found in source
✅ Delegated handler context:
    - /workspaces/conference-party-microservice/frontend/src/js/live-editor.js:1036:                    <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/analytics-privacy.js:357:                    <button onclick="this.closest('[role=modal]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:934:                <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1030:                <button onclick="this.closest('[style*=fixed]').remove(); standaloneLiveEditor.activateEditor();" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1039:                <button onclick="this.closest('[style*=fixed]').remove();" style="
• Related functions nearby (sample):
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:43:        <button id="mtm-disconnect">Disconnect</button>
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:96:    document.getElementById('mtm-disconnect')?.addEventListener('click', async () => {
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:97:      const res = await post('/disconnect');
    - /workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:104:    // This event can be dispatched by startOAuth to use message-based
    - /workspaces/conference-party-microservice/frontend/src/js/add-to-calendar-wrapper.js:5:export async function addToCalendar(ev) {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:191:                this.renderCalendarView();
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:226:                        ${events.map(event => this.renderCalendarEventCard(event)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:235:    renderCalendarView() {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:252:                ${weekDays.map(day => this.renderCalendarDay(day)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:290:    renderCalendarEventCard(event) {

▶ .btn-cal-m2m
⚠️  No occurrences found in source
✅ Delegated handler context:
    - /workspaces/conference-party-microservice/frontend/src/js/live-editor.js:1036:                    <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/analytics-privacy.js:357:                    <button onclick="this.closest('[role=modal]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:934:                <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1030:                <button onclick="this.closest('[style*=fixed]').remove(); standaloneLiveEditor.activateEditor();" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1039:                <button onclick="this.closest('[style*=fixed]').remove();" style="
• Related functions nearby (sample):
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:43:        <button id="mtm-disconnect">Disconnect</button>
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:96:    document.getElementById('mtm-disconnect')?.addEventListener('click', async () => {
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:97:      const res = await post('/disconnect');
    - /workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:104:    // This event can be dispatched by startOAuth to use message-based
    - /workspaces/conference-party-microservice/frontend/src/js/add-to-calendar-wrapper.js:5:export async function addToCalendar(ev) {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:191:                this.renderCalendarView();
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:226:                        ${events.map(event => this.renderCalendarEventCard(event)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:235:    renderCalendarView() {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:252:                ${weekDays.map(day => this.renderCalendarDay(day)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:290:    renderCalendarEventCard(event) {

▶ .btn-pin
⚠️  No occurrences found in source
✅ Delegated handler context:
    - /workspaces/conference-party-microservice/frontend/src/js/live-editor.js:1036:                    <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/analytics-privacy.js:357:                    <button onclick="this.closest('[role=modal]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:934:                <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1030:                <button onclick="this.closest('[style*=fixed]').remove(); standaloneLiveEditor.activateEditor();" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1039:                <button onclick="this.closest('[style*=fixed]').remove();" style="
• Related functions nearby (sample):
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:43:        <button id="mtm-disconnect">Disconnect</button>
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:96:    document.getElementById('mtm-disconnect')?.addEventListener('click', async () => {
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:97:      const res = await post('/disconnect');
    - /workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:104:    // This event can be dispatched by startOAuth to use message-based
    - /workspaces/conference-party-microservice/frontend/src/js/add-to-calendar-wrapper.js:5:export async function addToCalendar(ev) {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:191:                this.renderCalendarView();
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:226:                        ${events.map(event => this.renderCalendarEventCard(event)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:235:    renderCalendarView() {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:252:                ${weekDays.map(day => this.renderCalendarDay(day)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:290:    renderCalendarEventCard(event) {

▶ .day-pill
⚠️  No occurrences found in source
✅ Delegated handler context:
    - /workspaces/conference-party-microservice/frontend/src/js/live-editor.js:1036:                    <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/analytics-privacy.js:357:                    <button onclick="this.closest('[role=modal]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:934:                <button onclick="this.closest('[style*=fixed]').remove()" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1030:                <button onclick="this.closest('[style*=fixed]').remove(); standaloneLiveEditor.activateEditor();" style="
    - /workspaces/conference-party-microservice/frontend/src/js/standalone-live-editor.js:1039:                <button onclick="this.closest('[style*=fixed]').remove();" style="
• Related functions nearby (sample):
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:43:        <button id="mtm-disconnect">Disconnect</button>
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:96:    document.getElementById('mtm-disconnect')?.addEventListener('click', async () => {
    - /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:97:      const res = await post('/disconnect');
    - /workspaces/conference-party-microservice/frontend/src/js/oauth-message-handler.js:104:    // This event can be dispatched by startOAuth to use message-based
    - /workspaces/conference-party-microservice/frontend/src/js/add-to-calendar-wrapper.js:5:export async function addToCalendar(ev) {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:191:                this.renderCalendarView();
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:226:                        ${events.map(event => this.renderCalendarEventCard(event)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:235:    renderCalendarView() {
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:252:                ${weekDays.map(day => this.renderCalendarDay(day)).join('')}
    - /workspaces/conference-party-microservice/frontend/src/js/calendar.js:290:    renderCalendarEventCard(event) {

[1;36m=== 3) Endpoint usage (relative vs absolute) ===[0m
⚠️  Absolute endpoints in frontend (review):
  · /workspaces/conference-party-microservice/frontend/src/js/services/api.js:53:      ? 'http://localhost:5001/conference-party-app/us-central1/api'
  · /workspaces/conference-party-microservice/frontend/src/js/services/maps-loader.js:56:  script.src = `https://maps.googleapis.com/maps/api/js?key=${MAPS_CONFIG.apiKey}&v=${MAPS_CONFIG.version}&loading=async`;
  · /workspaces/conference-party-microservice/frontend/src/js/panels/mount-map.js:89:  script.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyD5Zj_Hj31Vda3bcybxX6W4zmDlg8cotgc&v=weekly&loading=async&libraries=marker';
✅ Relative /api calls found:
  · /workspaces/conference-party-microservice/frontend/src/js/hotspots-view.js:3: * - Fetches /api/hotspots
  · /workspaces/conference-party-microservice/frontend/src/js/hotspots-view.js:10:const API_URL = '/api/hotspots?conference=gamescom2025';
  · /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:13:  return fetch(`/api/integrations/mtm${path}`, {
  · /workspaces/conference-party-microservice/frontend/src/js/settings-mtm.js:139:      const res = await fetch('/api/integrations/mtm/status', {
  · /workspaces/conference-party-microservice/frontend/src/js/search-manager.js:75:            const response = await cache.match('/api/events');
  · /workspaces/conference-party-microservice/frontend/src/js/search-manager.js:92:            const response = await fetch('/api/parties', {
  · /workspaces/conference-party-microservice/frontend/src/js/search-manager.js:472:                cache.put('/api/parties', new Response(JSON.stringify(data)));
  · /workspaces/conference-party-microservice/frontend/src/js/analytics-core.js:259:            const response = await fetch('/api/analytics', {
  · /workspaces/conference-party-microservice/frontend/src/js/utils/performance-optimized.js:134:      '/api/health',
  · /workspaces/conference-party-microservice/frontend/src/js/utils/performance-optimized.js:135:      '/api/parties',
  · /workspaces/conference-party-microservice/frontend/src/js/utils/performance-optimized.js:136:      '/api/events'
  · /workspaces/conference-party-microservice/frontend/src/js/calendar-delegation.js:94:  const popup = window.open('/api/gcal/connect', 'gcal_connect',
  · /workspaces/conference-party-microservice/frontend/src/js/calendar-delegation.js:107:    const res = await fetch('/api/googleCalendar/create', {
  · /workspaces/conference-party-microservice/frontend/src/js/calendar-delegation.js:152:    const res = await fetch(`/api/calendar/ics?partyId=${encodeURIComponent(party.id)}`);
  · /workspaces/conference-party-microservice/frontend/src/js/services/api.js:11:  // GET /api/events?when=tonight
  · /workspaces/conference-party-microservice/frontend/src/js/services/calendar-client.js:13:    this.baseUrl = '/api/calendar';
  · /workspaces/conference-party-microservice/frontend/src/js/services/calendar-client.js:46:    const { url } = await authed('/api/calendar/google/start');
  · /workspaces/conference-party-microservice/frontend/src/js/services/calendar-client.js:63:    const { connected, events } = await authed(`/api/calendar/events?from=${encodeURIComponent(from)}&to=${encodeURIComponent(to)}`);
  · /workspaces/conference-party-microservice/frontend/src/js/services/calendar-client.js:70:    await authed('/api/calendar/create', {
  · /workspaces/conference-party-microservice/frontend/src/js/services/resilience.js:266:        const response = await fetch('/api/health');

[1;36m=== 4) Hosting rewrites ===[0m
  · 53:    "rewrites": [
  · 55:        "source": "/api/**",
  · 56:        "function": {
  · 57:          "functionId": "apiFn",
  · 67:  "functions": {
  · 68:    "source": "functions"
✅ Rewrite /api/** → Functions present

[1;36m=== 5) Live CSP header snapshot ===[0m
content-security-policy: default-src 'self'; connect-src 'self' https://firestore.googleapis.com https://identitytoolkit.googleapis.com https://www.googleapis.com https://maps.googleapis.com https://maps.gstatic.com; img-src 'self' data: https://maps.gstatic.com https://*.googleapis.com; script-src 'self' 'unsafe-inline' https://maps.googleapis.com https://accounts.google.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; frame-src https://accounts.google.com; frame-ancestors 'none'; base-uri 'self'

[1;36m=== 6) Live endpoint smoke check (no auth) ===[0m
GET https://conference-party-app.web.app/api/health -> 200
GET https://conference-party-app.web.app/api/parties?conference=gamescom2025 -> 200
POST https://conference-party-app.web.app/api/googleCalendar/create -> 401

[1;36m=== 7) Summary (actionable, still NO CHANGES) ===[0m
• For each selector above, confirm at least one DIRECT or DELEGATED click handler exists.
• Prefer RELATIVE /api paths. Flag any absolute run.app/googleapis calls used from UI.
• Ensure firebase.json has /api/** rewrite to the Functions entry.
• Compare CSP connect-src with the actual hosts seen in (3).
